# This is the GitLab CI/CD configuration file
stages:
  - build
  - deploy

# Define the job
build_docker_image:
  # This specifies the Docker image to use for the CI/CD pipeline
  image: docker:latest
  # Define services to be used in the pipeline
  services:
    - docker:dind
  stage: build
  tags:
    - windows
    - docker
  # Variables to be used in the pipeline
  variables:
    DOCKER_DRIVER: overlay2  # Docker storage driver
    IMAGE_NAME: kakazaro/gen-open-webui:latest  # Name of the Docker image
    DOCKERFILE: Dockerfile.renesas  # Name of the Dockerfile
    DOCKER_REGISTRY_USER: kakazaro
    DOCKER_REGISTRY_PASSWORD: antimage2blinK

  # Define the script that will run in the job
  script:
    # Build the Docker image using the specified Dockerfile
    - docker build -f $DOCKERFILE -t $IMAGE_NAME .
    # Log in
    - docker login -u $DOCKER_REGISTRY_USER -p $DOCKER_REGISTRY_PASSWORD
    # Push the Docker image
    - docker push $IMAGE_NAME

deploy:
  stage: deploy
  tags:
    - ui-nodejs
  script:
    - echo "hello world"
    # - bash ./run.renesas.sh